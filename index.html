<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EmpireBet Rollover</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts for style -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:600,700&display=swap" rel="stylesheet">
  <style>
    body {
      background: radial-gradient(circle at 70% 10%, #3a86ff 0%, #03071e 40%, #03071e 100%);
      min-height: 100vh;
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #f1faee;
    }
    .container {
      background: linear-gradient(135deg, #03071e 80%, #3a86ff44 100%);
      border-radius: 20px;
      box-shadow: 0 10px 40px 4px #000c, 0 2px 8px 0 #023e8a55;
      padding: 44px 32px 36px 32px;
      max-width: 370px;
      width: 98vw;
      text-align: center;
      border: 2.5px solid #4361ee;
      position: relative;
      backdrop-filter: blur(1.5px);
    }
    h1 {
      margin-top: 0;
      font-size: 2.4em;
      letter-spacing: 1.5px;
      color: #ffd60a;
      font-weight: 900;
      margin-bottom: 18px;
      text-shadow: 0 1px 12px #4361ee99, 0 0px 10px #ffd60a33;
    }
    .input-pin {
      margin: 30px 0 10px 0;
    }
    input[type="password"] {
      width: 130px;
      font-size: 2.1em;
      letter-spacing: 22px;
      padding: 12px 10px;
      text-align: center;
      border-radius: 12px;
      border: 2.5px solid #4361ee;
      background: #011627;
      color: #ffd60a;
      outline: none;
      margin-bottom: 10px;
      box-shadow: 0 1px 9px #000, 0 0px 2px #4361ee33;
      transition: border 0.3s;
    }
    input[type="password"]:focus {
      border: 2.5px solid #ffd60a;
      background: #1e293b;
    }
    input[type="password"]::-webkit-input-placeholder {
      color: #8ecae6;
      letter-spacing: 2px;
    }
    button {
      background: linear-gradient(87deg, #3a86ff 0%, #ffd60a 85%, #ffd60a 100%);
      color: #011627;
      border: none;
      border-radius: 10px;
      padding: 13px 32px;
      font-size: 1.13em;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
      box-shadow: 0 2px 8px #023e8a55;
      transition: background 0.18s, box-shadow 0.18s;
      letter-spacing: 1px;
    }
    button:active {
      background: linear-gradient(90deg, #ffd60a 0%, #3a86ff 100%);
      box-shadow: 0 1px 4px #023e8a77;
    }
    .loader {
      margin: 40px auto 0 auto;
      border: 7px solid #3a86ff33;
      border-top: 7px solid #ffd60a;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      animation: spin 1s linear infinite;
      display: block;
      box-shadow: 0 2px 8px #023e8a33;
    }
    @keyframes spin {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(360deg);}
    }
    .blink {
      animation: blinkText 0.7s steps(1, end) 8;
    }
    @keyframes blinkText {
      0%,100% { opacity: 1; }
      50% { opacity: 0; }
    }
    .error-msg {
      color: #ff477e;
      background: rgba(255,71,126,0.12);
      padding: 11px 0;
      margin: 15px 0 0 0;
      border-radius: 8px;
      font-weight: 700;
      letter-spacing: 1px;
      animation: shake 0.2s 2;
    }
    @keyframes shake {
      0% { transform: translateX(0);}
      25% { transform: translateX(-3px);}
      50% { transform: translateX(3px);}
      75% { transform: translateX(-3px);}
      100% { transform: translateX(0);}
    }
    .profile-section {
      padding: 0 8px 0 8px;
    }
    .profile-label {
      color: #ffd60a;
      font-size: 1.11em;
      margin-top: 20px;
      margin-bottom: 6px;
      font-weight: 600;
      letter-spacing: 1px;
      text-shadow: 0 1px 8px #ffd60a33;
    }
    .profile-pin {
      background: #011627;
      color: #ffd60a;
      padding: 8px 18px;
      border-radius: 8px;
      font-size: 1.25em;
      display: inline-block;
      margin-bottom: 24px;
      font-weight: bold;
      letter-spacing: 4px;
      border: 1.5px solid #ffd60a;
      box-shadow: 0 1px 9px #3a86ff33, 0 0px 2px #ffd60a33;
    }
    .profile-expiry {
      margin-top: 10px;
      font-size: 1em;
      color: #3a86ff;
      background: #011627;
      padding: 7px 13px;
      border-radius: 6px;
      display: inline-block;
      font-weight: 700;
      border: 1.5px solid #3a86ff;
      box-shadow: 0 1px 7px #011627, 0 0px 2px #3a86ff22;
      margin-bottom: 10px;
    }
    .ticket-section {
      margin-top: 22px;
      padding: 18px 12px 22px 12px;
      border-radius: 16px;
      background: linear-gradient(135deg, #4361ee22 0%, #ffd60a11 100%);
      box-shadow: 0 2px 15px #4361ee22;
      position: relative;
      border: 1.5px solid #4361ee66;
    }
    .ticket-section .title {
      color: #ffd60a;
      font-size: 1.16em;
      letter-spacing: 1.7px;
      font-weight: 700;
      margin-bottom: 12px;
      text-shadow: 0 1px 7px #ffd60a33;
    }
    .ticket-id-box {
      background: #3a86ff22;
      color: #3a86ff;
      padding: 12px 14px;
      font-size: 1.15em;
      border-radius: 8px;
      letter-spacing: 2px;
      margin-bottom: 18px;
      font-family: 'Montserrat', monospace;
      display: inline-block;
      font-weight: 700;
      border: 1.5px dashed #3a86ff;
      user-select: text;
      box-shadow: 0 1px 7px #023e8a33;
    }
    .booking-box {
      background: #ffd60a11;
      color: #ffd60a;
      padding: 15px 10px;
      font-size: 1.18em;
      border-radius: 8px;
      word-break: break-all;
      letter-spacing: 2px;
      margin-bottom: 12px;
      position: relative;
      font-family: 'Montserrat', monospace;
      border: 2px dashed #ffd60a;
      box-shadow: 0 0 12px #ffd60a33;
      transition: box-shadow 0.2s;
      display: inline-block;
      min-width: 120px;
      font-weight: 700;
      text-shadow: 0 1px 8px #ffd60a44;
    }
    .copy-btn, .generate-btn {
      display: block;
      width: 100%;
      margin-top: 8px;
      border-radius: 8px;
      background: linear-gradient(87deg, #3a86ff 0%, #ffd60a 85%, #ffd60a 100%);
      color: #011627;
      font-weight: bold;
      border: none;
      padding: 13px 0;
      cursor: pointer;
      font-size: 1.07em;
      transition: background 0.18s;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px #023e8a55;
    }
    .copy-btn:active, .generate-btn:active {
      background: linear-gradient(90deg, #ffd60a 0%, #3a86ff 100%);
    }
    .expire-notice {
      color: #ff477e;
      font-size: 1.2em;
      font-weight: bold;
      margin-top: 17px;
      margin-bottom: 27px;
      animation: blinkNotice 1s steps(1, end) infinite;
      text-shadow: 0 1px 8px #ff477e44;
    }
    .notice-msg {
      color: #ff477e;
      background: #ff477e16;
      border: 1.5px solid #ff477e;
      border-radius: 8px;
      font-weight: bold;
      font-size: 1.13em;
      margin-top: 25px;
      margin-bottom: 18px;
      padding: 15px 10px;
      box-shadow: 0 1px 8px #ff477e22;
      animation: blinkNotice 1s steps(1, end) infinite;
    }
    @keyframes blinkNotice {
      0%,100% { opacity: 1;}
      50% { opacity: 0;}
    }
    .renew-btn {
      background: linear-gradient(90deg, #ff477e 60%, #4361ee 100%);
      color: #fff;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      padding: 13px 0;
      width: 100%;
      font-size: 1.11em;
      margin-top: 20px;
      box-shadow: 0 2px 8px #ff477e44;
      cursor: pointer;
      transition: background 0.18s;
      letter-spacing: 1px;
    }
    .renew-btn:active {
      background: linear-gradient(90deg, #4361ee 60%, #ff477e 100%);
    }
    .loader-text {
      color: #ffd60a;
      font-size: 1.13em;
      font-weight: 600;
      margin-top: 27px;
      letter-spacing: 1px;
      text-align: center;
      min-height: 35px;
      text-shadow: 0 1px 8px #ffd60a44;
    }
    #code-gen-message .loader-text {
      color: #3a86ff;
      font-size: 1.17em;
      text-shadow: 0 1px 8px #3a86ff44;
    }
    .branding {
      margin-top: 18px;
      color: #3a86ff;
      font-size: 0.93em;
      letter-spacing: 1.2px;
      font-weight: 500;
      opacity: 0.8;
      text-shadow: 0 1px 8px #3a86ff44;
      user-select: none;
    }
    @media (max-width: 480px) {
      .container { padding: 21px 2vw;}
      h1 { font-size: 1.4em;}
      input[type="password"] { width: 90px; font-size: 1.4em;}
    }
  </style>
</head>
<body>
  <div class="container" id="main-container">
    <h1>EmpireBet Rollover</h1>
    <div id="login-form">
      <div class="input-pin">
        <input type="password" id="pin-input" pattern="\d*" inputmode="numeric"
          maxlength="4" placeholder="PIN" autocomplete="off"/>
      </div>
      <button onclick="onLogin()">Open Profile</button>
      <div id="login-error" class="error-msg" style="display:none;"></div>
    </div>
    <div id="loader-section" style="display:none;">
      <div class="loader"></div>
      <div class="loader-text blink" id="loader-text">Opening Profile</div>
    </div>
    <div id="profile-section" style="display:none;"></div>
    <div id="generate-loader" style="display:none;">
      <div class="loader"></div>
      <div class="loader-text blink" id="generating-text">Generating code...</div>
    </div>
    <div id="code-gen-message" style="display:none;">
      <div class="loader-text" id="code-gen-info">Code Generated, PASTE your code in provide link. please wait you will be redirected shortly!</div>
    </div>
    <div id="notice-section" style="display:none;">
      <div class="notice-msg" id="notice-msg"></div>
    </div>
    <div id="renew-loader" style="display:none;">
      <div class="loader"></div>
      <div class="loader-text blink">You will be redirected shortly...</div>
    </div>
    <div class="branding">EmpireBet &copy; 2025</div>
  </div>
  <script>
    // All users have the same booking code now
    const GLOBAL_BOOKING_CODE = "BOOK-2025-POWERWIN";
    // This is the link users are redirected to after generating the betting code
    const GLOBAL_BETTING_CODE_LINK = "https://www.sportybet.com/ng/m/code-hub/load-code?source=home";
    
    // Set up users and their Ticket IDs (admin provides)
    const users = [
      {
        pin: "2004",
        expiry: "2025-08-31",
        ticketId: "EMPIRE-007-PUCD",
        renewLink: "https://paystack.shop/pay/tonk0bpr5w"
      },
      {
        pin: "3572",
        expiry: "2025-08-31",
        ticketId: "EMPIRE-009-ROYZ",
        renewLink: "https://paystack.shop/pay/tonk0bpr5w"
      },
      {
        pin: "2468",
        expiry: "2025-07-30",
        ticketId: "EMPIRE-101-FGHI",
        renewLink: "https://paystack.shop/pay/tonk0bpr5w"
      }
      // Add more users as needed
    ];

    function formatDate(dateStr) {
      let d = new Date(dateStr);
      return d.toLocaleDateString(undefined, {month: 'short', day: 'numeric', year: 'numeric'});
    }

    // Get today's date in YYYY-MM-DD
    function today() {
      const d = new Date();
      return d.toISOString().split('T')[0];
    }

    // PIN to User
    function findUserByPIN(pin) {
      return users.find(u => u.pin === pin);
    }

    // Restrict input to only numbers, up to 4 digits
    document.getElementById('pin-input').addEventListener('input', function(e) {
      this.value = this.value.replace(/\D/g, '').slice(0, 4);
    });

    let currentUser = null;
    let codeGenerated = false;

    // Login handler
    function onLogin() {
      const pin = document.getElementById('pin-input').value;
      document.getElementById('login-error').style.display = 'none';
      if (pin.length !== 4) {
        showError("Please enter your 4-digit PIN.");
        return;
      }
      const user = findUserByPIN(pin);
      if (!user) {
        showError("Access denied! The PIN you entered is not correct.");
        return;
      }
      currentUser = user;
      showLoader();
    }

    function showError(msg) {
      let el = document.getElementById('login-error');
      el.innerText = msg;
      el.style.display = '';
    }

    // Show loader for 4 blinks then show profile
    function showLoader() {
      document.getElementById('login-form').style.display = 'none';
      document.getElementById('profile-section').style.display = 'none';
      document.getElementById('loader-section').style.display = '';
      let blinkCount = 0;
      let loaderText = document.getElementById('loader-text');
      loaderText.classList.add('blink');
      const loaderInt = setInterval(() => {
        blinkCount++;
        if (blinkCount >= 4) {
          clearInterval(loaderInt);
          loaderText.classList.remove('blink');
          showProfile();
        }
      }, 700);
    }

    // Profile rendering
    function showProfile() {
      document.getElementById('loader-section').style.display = 'none';
      document.getElementById('notice-section').style.display = 'none';
      const expired = today() > currentUser.expiry;
      let html = `<div class="profile-section">`;

      if (!expired) {
        html += `
          <div class="profile-label">Your PIN</div>
          <div class="profile-pin">${currentUser.pin}</div>
          <div class="profile-expiry">Expires: ${formatDate(currentUser.expiry)}</div>
          <div class="ticket-section">
            <div class="title">Your Ticket ID For The Month</div>
            <div class="ticket-id-box" id="ticket-id-box">${currentUser.ticketId}</div>
            <div style="margin-top: 16px;">
              <button class="generate-btn" id="generate-btn">Generate Betting Code</button>
            </div>
            <div id="booking-code-section" style="display:none;">
              <div class="profile-label" style="margin-top:18px">Betting Code</div>
              <div class="booking-box" id="booking-box">${GLOBAL_BOOKING_CODE}</div>
            </div>
          </div>
        `;
      } else {
        html += `
          <div class="expire-notice">
            Your Ticket Has Expired. Payment getway is open every 1st day of the Month.<br>
            Resubscribe to gain back access
          </div>
          <button class="renew-btn" id="renew-btn">Renew Ticket</button>
        `;
      }

      html += `</div>`;

      document.getElementById('profile-section').innerHTML = html;
      document.getElementById('profile-section').style.display = '';

      if (!expired) {
        document.getElementById('generate-btn').addEventListener('click', onGenerateBettingCode);
      } else {
        document.getElementById('renew-btn').onclick = onRenewTicket;
      }
      codeGenerated = false;
    }

    // Betting code generation process with time restriction
    function onGenerateBettingCode() {
      // Time range: 10:00 (AM) to 20:00 (8:00 PM)
      const now = new Date();
      const currentHour = now.getHours();
      const currentMinute = now.getMinutes();

      // Time boundaries in minutes since midnight
      const minMinutes = 10 * 60; // 10:00 AM
      const maxMinutes = 20 * 60; // 8:00 PM
      const nowMinutes = currentHour * 60 + currentMinute;

      // If not in the valid range, show notice
      if (nowMinutes < minMinutes || nowMinutes >= maxMinutes) {
        let msg = "";
        if (nowMinutes < minMinutes) {
          // Before 10:00 AM
          msg = `You can only generate the betting code from <b>10:00 AM</b> up to <b>8:00 PM</b> daily.<br>Please try again at <span style="color:#3a86ff"><b>10:00 AM</b></span>.`;
        } else {
          // After 8:00 PM
          msg = `Betting code generation has closed for today.<br>Please try again tomorrow from <span style="color:#3a86ff"><b>10:00 AM</b></span> up to <span style="color:#3a86ff"><b>8:00 PM</b></span>.`;
        }
        document.getElementById('profile-section').style.display = 'none';
        document.getElementById('notice-msg').innerHTML = msg;
        document.getElementById('notice-section').style.display = '';
        return;
      }

      if (codeGenerated) return;
      codeGenerated = true;
      document.getElementById('profile-section').style.display = 'none';
      document.getElementById('notice-section').style.display = 'none';
      document.getElementById('generate-loader').style.display = '';
      document.getElementById('generating-text').innerText = "Generating code...";

      setTimeout(() => {
        document.getElementById('generate-loader').style.display = 'none';
        document.getElementById('code-gen-message').style.display = '';
        document.getElementById('code-gen-info').innerText = "Code Generated";
        // Show code for 2 seconds, then show code for 4s before redirect (total 6s)
        setTimeout(() => {
          document.getElementById('code-gen-message').style.display = 'none';
          document.getElementById('profile-section').style.display = '';
          document.getElementById('booking-code-section').style.display = '';
          setTimeout(() => {
            window.location.href = GLOBAL_BETTING_CODE_LINK;
          }, 4000);
        }, 2000);
      }, 2000);
    }

    // Renew Ticket Handler
    function onRenewTicket() {
      document.getElementById('profile-section').style.display = 'none';
      document.getElementById('renew-loader').style.display = '';
      setTimeout(() => {
        window.location.href = currentUser.renewLink;
      }, 1800);
    }

    // Prevent copy of booking code as before (optional)
    document.addEventListener('copy', function(e) {
      if (!codeGenerated) {
        if (document.activeElement && document.activeElement.id === 'booking-box') {
          e.preventDefault();
          alert("You must generate the betting code first!");
        }
      }
    });

    document.addEventListener('contextmenu', function(e) {
      if (e.target && e.target.id === 'booking-box' && !codeGenerated) {
        e.preventDefault();
        alert("You need to generate the betting code first.");
      }
    });
  </script>
</body>
</html>
